"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const ProgressBar = require("progress");
const core_1 = require("./core");
exports.discoverFactories = core_1.discoverFactories;
exports.findMatchInFile = core_1.findMatchInFile;
exports.indexFiles = core_1.indexFiles;
exports.processFactories = core_1.processFactories;
const pate = (matchPattern, searchPath, { barOptions, barStyle, globPattern, ignorePattern, verbose, }) => new Promise(async (resolve, reject) => {
    try {
        const files = await core_1.indexFiles(globPattern, searchPath, ignorePattern);
        const bar = verbose &&
            new ProgressBar(barStyle, Object.assign({}, barOptions, { total: files.length }));
        const factories = core_1.discoverFactories(files, matchPattern, bar);
        const { matchedFiles, skippedFiles, } = await core_1.processFactories(factories);
        resolve({
            matchedFiles,
            skippedFiles,
        });
    }
    catch (error) {
        reject(error);
    }
});
exports.default = pate;
